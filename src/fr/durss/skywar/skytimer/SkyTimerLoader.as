package fr.durss.skywar.skytimer {	import flash.filters.GlowFilter;	import flash.display.DisplayObject;	import flash.display.MovieClip;	import flash.display.StageAlign;	import flash.display.StageScaleMode;	import flash.events.Event;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;	import flash.utils.getDefinitionByName;	/**	 * 	 * @author Fran√ßois	 */	public class SkyTimerLoader extends MovieClip {
		private var _percentTxt:TextField;		private var _spinning:MainLoaderGraphics;						/* *********** *		 * CONSTRUCTOR *		 * *********** */		public function SkyTimerLoader() {			stop();			stage.align				= StageAlign.TOP_LEFT;			stage.scaleMode			= StageScaleMode.NO_SCALE;			stage.stageFocusRect	= false;			_percentTxt				= new TextField();			_percentTxt.textColor	= 0x000000;			_percentTxt.autoSize	= TextFieldAutoSize.CENTER;			_spinning				= addChild(new MainLoaderGraphics()) as MainLoaderGraphics;			_spinning.filters		= [new GlowFilter(0x272B24, 1, 5, 5, 1.5, 3)];			addChild(_percentTxt);			addEventListener(Event.ENTER_FRAME, onEnterFrame);		}						/* ***************** *		 * GETTERS / SETTERS *		 * ***************** */		/* ****** *		 * PUBLIC *		 * ****** */						/* ******* *		 * PRIVATE *		 * ******* */		/**		 * Displaus the loader on ENTER_FRAME event.		 */		private function onEnterFrame(e:Event):void {			graphics.clear();			if(framesLoaded == totalFrames && loaderInfo.bytesLoaded == loaderInfo.bytesTotal) {				removeEventListener(Event.ENTER_FRAME, onEnterFrame);				removeChild(_percentTxt);				removeChild(_spinning);				nextFrame();				initialize();			} else {				var percent:Number = root.loaderInfo.bytesLoaded / root.loaderInfo.bytesTotal;				percent = Math.round(percent * 100);				_percentTxt.htmlText	= "<font size=\"10\">"+percent+"</font>";			}			_spinning.rotation -= 25;			_percentTxt.x	= Math.round((stage.stageWidth - _percentTxt.width) * .5) + 2;			_percentTxt.y	= Math.round((stage.stageHeight - _percentTxt.height) * .5);			_spinning.x		= Math.round((stage.stageWidth) * .5) + 1;			_spinning.y		= Math.round((stage.stageHeight) * .5);		}				/**		 * Initialize the application once the loading has completed and the		 * current frame is the second.		 */		private function initialize():void {			var mainClass:Class = getDefinitionByName("fr.durss.skywar.skytimer.SkyTimer") as Class;			if(mainClass) {				var app:Object = new mainClass();				addChild(app as DisplayObject);			}		}	}}